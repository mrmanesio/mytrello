# Фильтрация и поиск задач

## Описание

Добавлена функциональность фильтрации задач по статусу выполнения и поиска задач по названию с подсветкой совпадающего текста. Фильтрация и поиск происходят на уровне UI, данные в Redux store не изменяются. Фильтры и поиск интегрированы в компонент Header для удобного доступа.

## Компоненты

### Header (обновлен)

Компонент заголовка теперь включает функциональность фильтрации и поиска задач.

**Расположение:** `src/components/Header/`

**Новая функциональность:**
- Строка поиска с иконкой лупы
- Отображение трех вариантов фильтрации: "Все", "Выполненные", "Невыполненные"
- Визуальное выделение активного фильтра
- Обработка переключения между фильтрами
- Интеграция с существующими кнопками "Меню" и "Добавить"

**Новые пропсы:**
- `currentFilter?: TaskFilterType` - текущий активный фильтр (по умолчанию 'all')
- `onFilterChange?: (filter: TaskFilterType) => void` - функция для изменения фильтра
- `searchQuery?: string` - текущий поисковый запрос
- `onSearchChange?: (query: string) => void` - функция для изменения поискового запроса

**Типы фильтров:**
```typescript
type TaskFilterType = 'all' | 'completed' | 'incomplete';
```

### TaskCard (обновлен)

Компонент карточки задачи теперь поддерживает подсветку совпадающего текста.

**Расположение:** `src/components/TaskCard/`

**Новая функциональность:**
- Подсветка совпадающего текста в названии задачи
- Компонент `HighlightedText` для визуального выделения
- Стили для подсветки с желтым фоном и темным текстом

**Новые пропсы:**
- `searchQuery?: string` - поисковый запрос для подсветки

**Компонент HighlightedText:**
```typescript
const HighlightedText: React.FC<{ text: string; searchQuery: string }> = ({
  text,
  searchQuery,
}) => {
  // Логика подсветки совпадающего текста
};
```

### Column (обновлен)

Компонент колонки теперь передает поисковый запрос в карточки задач.

**Новые пропсы:**
- `searchQuery?: string` - поисковый запрос для передачи в TaskCard

### TaskFilter (устарел)

Компонент TaskFilter больше не используется, так как фильтрация перенесена в Header.

## Интеграция

### Board компонент

Фильтрация и поиск интегрированы в компонент Board:

1. **Состояние фильтра:** Добавлено локальное состояние `taskFilter` с типом `TaskFilterType`
2. **Состояние поиска:** Добавлено локальное состояние `searchQuery` типа string
3. **Функция фильтрации по статусу:** Реализована функция `filterTasksByStatus`, которая фильтрует задачи по статусу выполнения
4. **Функция фильтрации по поиску:** Реализована функция `filterTasksBySearch`, которая фильтрует задачи по названию (игнорирует регистр)
5. **Комбинированная фильтрация:** Функция `filterTasks` применяет оба фильтра последовательно
6. **Применение фильтра:** Функция `getTasksForColumn` теперь применяет комбинированный фильтр к задачам колонки
7. **UI компонент:** Фильтрация и поиск передаются в компонент `Header`
8. **Передача поиска:** Поисковый запрос передается через ColumnWrapper в Column и далее в TaskCard

### Логика фильтрации

```typescript
// Фильтрация по статусу
const filterTasksByStatus = (tasks: any[]) => {
  switch (taskFilter) {
    case 'completed':
      return tasks.filter(task => task.completed);
    case 'incomplete':
      return tasks.filter(task => !task.completed);
    default:
      return tasks;
  }
};

// Фильтрация по поиску
const filterTasksBySearch = (tasks: any[]) => {
  if (!searchQuery.trim()) {
    return tasks;
  }
  
  const query = searchQuery.toLowerCase().trim();
  return tasks.filter(task => task.title.toLowerCase().includes(query));
};

// Комбинированная фильтрация
const filterTasks = (tasks: any[]) => {
  const statusFiltered = filterTasksByStatus(tasks);
  return filterTasksBySearch(statusFiltered);
};
```

### Логика подсветки

```typescript
const HighlightedText: React.FC<{ text: string; searchQuery: string }> = ({
  text,
  searchQuery,
}) => {
  if (!searchQuery.trim()) {
    return <>{text}</>;
  }

  const query = searchQuery.toLowerCase();
  const lowerText = text.toLowerCase();
  const index = lowerText.indexOf(query);

  if (index === -1) {
    return <>{text}</>;
  }

  const before = text.substring(0, index);
  const match = text.substring(index, index + query.length);
  const after = text.substring(index + query.length);

  return (
    <>
      {before}
      <mark className={styles.taskCard__highlight}>{match}</mark>
      {after}
    </>
  );
};
```

## Стили

Стили фильтрации и поиска интегрированы в `src/components/Header/styles/Header.module.scss`:

- Строка поиска отображается между заголовком и фильтрами
- Поиск имеет иконку лупы справа
- Фильтры отображаются в правой части header рядом с кнопками "Меню" и "Добавить"
- Современный дизайн с использованием Flexbox
- Анимации при наведении и переключении
- Визуальное выделение активного фильтра
- Адаптивная верстка

Стили подсветки в `src/components/TaskCard/styles/TaskCard.module.scss`:

```scss
&__highlight {
  background-color: #fff3cd;
  color: #856404;
  padding: 0 2px;
  border-radius: 2px;
  font-weight: 600;
}
```

## Использование

1. Откройте приложение MyTrello
2. В центральной части заголовка появится строка поиска
3. Введите текст для поиска задач по названию (поиск нечувствителен к регистру)
4. Совпадающий текст в названиях задач будет подсвечен желтым цветом
5. В правой части заголовка появится панель фильтрации
6. Выберите нужный фильтр:
   - **Все** - отображаются все задачи
   - **Выполненные** - отображаются только выполненные задачи
   - **Невыполненные** - отображаются только невыполненные задачи

## Особенности реализации

- Фильтрация и поиск происходят в реальном времени
- Поиск нечувствителен к регистру
- Подсветка совпадающего текста работает для частичных совпадений
- Состояние фильтра и поиска сохраняется только в компоненте Board
- При перезагрузке страницы фильтр сбрасывается к "Все", поиск очищается
- Фильтрация и поиск не влияют на данные в Redux store
- Поддерживается работа с drag-and-drop для отфильтрованных задач
- Фильтры и поиск интегрированы в header для лучшего UX
- Поиск работает только по названию задачи (не по описанию)
- Подсветка использует HTML тег `<mark>` с кастомными стилями
- Подсветка работает только для первого совпадения в названии

## Архитектурные изменения

- Удален отдельный компонент TaskFilter
- Фильтрация и поиск интегрированы в Header компонент
- Создан отдельный файл типов `src/types/filter.ts`
- Обновлены тесты для Header компонента
- Добавлены новые типы для поиска: `TaskSearchState`
- Создан компонент `HighlightedText` для подсветки текста
- Обновлены типы TaskCard, Column и ColumnWrapper для поддержки поиска
- Добавлены стили для подсветки совпадающего текста
- Созданы тесты для проверки функциональности подсветки 